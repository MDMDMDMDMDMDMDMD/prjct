# REST API для мебельного магазина

Это REST API сервис для небольшого мебельного магазина, разработанный на FastAPI. Он позволяет просматривать каталог товаров и управлять заказами.

## Технологии
- **Backend**: FastAPI
- **База данных**: PostgreSQL
- **Контейнеризация**: Docker, Docker Compose
- **ORM**: SQLAlchemy

---

## Как запустить проект (с помощью Docker)

Это рекомендуемый способ для быстрого старта.

1. **Клонируйте репозиторий:**
   ```bash
   git clone <URL репозитория>
   cd prjct
   ```

2. **Создайте файл `.env`** в корневой директории проекта и заполните его по примеру ниже. Эти переменные будут использоваться как контейнером с приложением, так и контейнером с базой данных.

   ```env
    # Настройки для подключения к БД из приложения
    DATABASE_URL=postgresql://postgres:postgres@db:5432/furniture_db
    
    # Настройки для инициализации самой БД
    POSTGRES_DB=furniture_db
    POSTGRES_USER=postgres
    POSTGRES_PASSWORD=postgres
    
    # Настройки для отправки почты (опционально)
    SMTP_HOST=mailhog
    SMTP_PORT=1025

   ```

3. **Запустите проект с помощью Docker Compose:**
   ```bash
   docker-compose up --build
   ```
   Сервис будет доступен по адресу `http://localhost:8000`.

---

## Локальная установка (без Docker)

Этот способ подходит для разработки и отладки.

1. **Клонируйте репозиторий** и перейдите в его директорию.

2. **Создайте и активируйте виртуальное окружение:**
   ```bash
   # Для Windows
   python -m venv venv
   .\venv\Scripts\activate

   # Для macOS/Linux
   python3 -m venv venv
   source venv/bin/activate
   ```

3. **Установите зависимости:**
   ```bash
   pip install -r requirements.txt
   ```

4. **Настройте переменные окружения.** Создайте файл `.env` (как в Docker-инструкции), но измените `DATABASE_URL`, чтобы он указывал на ваш локальный PostgreSQL.

5. **Запустите Uvicorn сервер:**
   ```bash
   uvicorn app.main:app --reload
   ```

---

## API Endpoints и документация

FastAPI предоставляет интерактивную документацию для всех эндпоинтов. После запуска сервера перейдите по одному из следующих URL:

- **Swagger UI**: `http://localhost:8000/docs`
- **ReDoc**: `http://localhost:8000/redoc`

### Основные эндпоинты:

#### Мебель (`/furniture`)
- `GET /furniture/`: Получить список всей мебели.
  - **Query-параметр (опционально):** `?category={название_категории}` для фильтрации по категории.
- `GET /furniture/{id}/`: Получить информацию о конкретном товаре по его ID.

#### Заказы (`/orders`)
- `POST /orders/`: Создать новый заказ.
  - **Тело запроса (JSON):**
    ```json
    {
      "email": "client@example.com",
      "item_ids": [1, 3, 5]
    }
    ```
- `GET /orders/`: Получить список заказов по email клиента.
  - **Query-параметр:** `?email={email_клиента}`.

---

## Структура проекта

- `app/api/`: Роутеры FastAPI, определяют эндпоинты.
- `app/crud/`: Функции для взаимодействия с базой данных (Create, Read, Update, Delete).
- `app/models/`: Модели SQLAlchemy, описывающие таблицы в базе данных.
- `app/schemas/`: Схемы Pydantic для валидации данных в запросах и форматирования ответов.
- `app/core/`: Конфигурация приложения, настройки базы данных и другие базовые компоненты.